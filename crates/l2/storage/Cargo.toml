[package]
name = "ethrex-storage-rollup"
version.workspace = true
edition.workspace = true
authors.workspace = true
documentation.workspace = true


[dependencies]
ethrex-common = { workspace = true, default-features = false }
ethrex-storage = { workspace = true, default-features = false }
ethrex-l2-common = { workspace = true, default-features = false }
ethrex-trie.workspace = true
ethrex-rlp.workspace = true

ethereum-types.workspace = true

async-trait.workspace = true
futures.workspace = true
anyhow = "1.0.86"
thiserror.workspace = true
tracing.workspace = true
libsql = { workspace = true, optional = true }
# NOTE: intentionally avoiding the workspace dep as it brings "full" features, breaking the provers
# We only need the runtime for the blocking databases to spawn blocking tasks
tokio = { workspace = true, optional = true, features = ["rt", "test-util"] }
bincode = "1.3.3"

[features]
default = ["l1"]

l2 = []

secp256k1 = ["ethrex-l2-common/secp256k1"]
k256 = ["ethrex-l2-common/k256"]

c-kzg = [
    "ethrex-common/c-kzg",
    "ethrex-l2-common/c-kzg",
    "ethrex-storage/c-kzg",
]
kzg-rs = [
    "ethrex-common/kzg-rs",
    "ethrex-l2-common/kzg-rs",
    "ethrex-storage/kzg-rs",
]

l1 = ["ethrex-common/l1", "ethrex-storage/l1", "ethrex-l2-common/l1"]
sp1 = ["ethrex-common/sp1", "ethrex-storage/sp1", "ethrex-l2-common/sp1"]
risc0 = [
    "ethrex-common/risc0",
    "ethrex-storage/risc0",
    "ethrex-l2-common/risc0",
]

sql = ["dep:libsql", "dep:tokio"]

[lib]
name = "ethrex_storage_rollup"
path = "src/lib.rs"

[lints.clippy]
unwrap_used = "deny"
expect_used = "deny"
indexing_slicing = "deny"
as_conversions = "deny"
unnecessary_cast = "warn"
panic = "deny"
